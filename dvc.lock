schema: '2.0'
stages:
  download_and_extract:
    cmd: python download_data.py
    deps:
    - path: download_data.py
      hash: md5
      md5: 81b0f5c6b6a2fd662eac9cb72f2cc3ac
      size: 3026
    params:
      params.yaml:
        images_dir: images
        images_url: https://www.robots.ox.ac.uk/~vgg/data/flowers/102/102flowers.tgz
        labels_dir: labels
        labels_url: https://www.robots.ox.ac.uk/~vgg/data/flowers/102/imagelabels.mat
    outs:
    - path: images
      hash: md5
      md5: a0449cfa1b8eceb5c25fee9b868938b8.dir
      size: 346809251
      nfiles: 8189
    - path: labels
      hash: md5
      md5: 320f29b8d24b5b589814d074931512e1.dir
      size: 502
      nfiles: 1
  process_data:
    cmd: python process_data.py
    deps:
    - path: images
      hash: md5
      md5: a0449cfa1b8eceb5c25fee9b868938b8.dir
      size: 346809251
      nfiles: 8189
    - path: labels
      hash: md5
      md5: 320f29b8d24b5b589814d074931512e1.dir
      size: 502
      nfiles: 1
    - path: process_data.py
      hash: md5
      md5: 64257f9029fbd223419241d1c3b0d940
      size: 6393
    params:
      params.yaml:
        batch_names_select:
        - '0'
        - '1'
        n_batches: 6
        random_state: 42
        test_size: 0.2
        test_split_path: test.csv
        train_split_path: train.csv
        val_size: 0.2
        val_split_path: val.csv
    outs:
    - path: test.csv
      hash: md5
      md5: 26b740bc29e0da30872419a317a046fa
      size: 129049
    - path: train.csv
      hash: md5
      md5: 26cb3821b572f40c9266495948be2c3f
      size: 141298
    - path: val.csv
      hash: md5
      md5: b146477d78c8b6603378289fa9ed9aea
      size: 35271
  train:
    cmd: python train.py
    deps:
    - path: train.csv
      hash: md5
      md5: 26cb3821b572f40c9266495948be2c3f
      size: 141298
    - path: train.py
      hash: md5
      md5: 0a6361b825cbef36b8a35b999382d56c
      size: 3033
    - path: val.csv
      hash: md5
      md5: b146477d78c8b6603378289fa9ed9aea
      size: 35271
    params:
      params.yaml:
        lr: 0.001
        model_save_path: best_model.pth
    outs:
    - path: best_model.pth
      hash: md5
      md5: c79bd6239cc9ebebeab18ef63eaf853a
      size: 1259496
  test:
    cmd: python test.py
    deps:
    - path: best_model.pth
      hash: md5
      md5: c79bd6239cc9ebebeab18ef63eaf853a
      size: 1259496
    - path: test.csv
      hash: md5
      md5: 26b740bc29e0da30872419a317a046fa
      size: 129049
    - path: test.py
      hash: md5
      md5: ed9dc3779401830975c0b9e3364f24db
      size: 1706
    params:
      params.yaml:
        model_save_path: best_model.pth
